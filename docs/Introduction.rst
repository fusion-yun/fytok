.. include:: common.rst

***********************************
Introduction 介绍
***********************************

Purpose 目标
==============

|FyTok| 的基本任务是实现一个 |Tokamak| *模拟器 (Simulator)*，
最终目标是构建 |Tokamak| 的 *数字孪生(Digital Twin)* :cite:`grieves_digital_2017`。 

|Tokamak| 是一个由多个复杂子系统耦合而成的大科学系统装置。每个子系统中都蕴含了大量不同时空尺度、不同
物理机制复杂过程。这些物理过程各自成体系，又相互紧密联系。很难在用单一的数值模型下描述整个复杂体系的
多时空尺度过程。所以，需要分别对各个子系统上的不同物理过程进行建模，形成针对单独子系统的数值模型。
并使子系统间的相互作用以数据的方式在模型中传递，互为输入输出。最终，将子系统数值模型整合在一起形成
全装置的“模拟器”，一个“*数字*”的 |Tokamak| 孪生。

几十年来，聚变领域内针对不同物理过程开发了许多优秀、完善数值模型和模拟分析程序。|FyTok| 通过构造统一的
数据模型（Data Model），将这些程序整合在一个的架构下，完成耦合，实现整体装置的模拟。传统程序的开发时间
跨越了几个世代，地域上也遍布全球各地，开发语言各异，接口不统一。这些程序的集成耦合是一个极具挑战性的任务。


|FyTok| 的主要应用主要包含以下两个方向  :cite:`pinches_iter_2014` :

* 支持装置运行控制:

     * 与等离子体控制系统（PCS）整合仿真，以评估其可靠性； 
     * 基于1.5维输运模型的放电建模，实现对等离子体放电场景规划和验证； 

* 支持等离子体物理研究
     
     * 物理模型改进和验证
     * 发展放电方案

详见  :ref:`Requirements 需求`

 
Background 背景
=================
|Tokamak| 放电建模的首要问题是对等离子体芯部输运问题的求解，不同子系统和物理过程的模拟结果围绕着输运模型耦合在一起
最终形成整个装置约束等离子体的模型。早期的输运模拟可以追溯到上世纪六十年代，B.B.Kadomtsev和 O.P.Pogutse首次系统讨论
这一问题 :cite:`leontovich_turbulence_1970`。当时 Yu. N. Dnestrovski 和  D. P. Kostomarov 开发了最早的输运程序  :cite:`dnestrovskii_abstracts_1969,dnestrovskii_numerical_2011`。
十余年后，Hinton, F. L. and Hazeltine, R. D. 再一次对环位形下的输运问题进行归纳总结 :cite:`hinton_theory_1976`。
他们的结果被后续大多数的输运程序所采用，以磁面平均后的一维输运方程与二位磁平衡求解相结合，构成所谓的“1.5维模拟”。

输运建模需要将许多不同的程序集成在一起，所以又称为“集成建模”。集成建模整合多个不同领域的模拟程序，程序间数据接口和
执行工作流的调度等问题需要在一个共同的环境下完成，即“集成建模框架”，也就是通常所指的“集成建模程序 （Integrated Modelling Code）”
或“集成建模工作流（IM workflow）”。下表  `集成建模程序清单`_ 罗列了近四十年来国际上不同机构开发的部分集成建模程序。
在这些程序之外还有许多各有特色的输运程序，如TSC (US) :cite:`kessel_long_2006`, CORSIS(US) :cite:`crotinger_corsica_1997`, 
METIS(FR) :cite:`artaud_metis_2018`等等。

早期程序侧重于对于实验结果进行输运分析，如 TRANSP 或者 Automated System for TRansport Analysis (ASTRA)。后发展出能够
完整再现放电过程中爬升、平顶、下降三段过程的能力，并开始用于验证等离子体控制系统（PCS），规划放电波形，成为所谓的
“ |Tokamak| 模拟器”，例如 Europen Transport Simulator (ETS)。近年来，“集成建模”程序的用途更加多样化，工具也越发
丰富以工具集的形式呈现，如Integrated Modelling & Analysis Suite(IMAS) 等。


.. _`集成建模程序清单`:

+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
|    名称                                                       |   开发国家 单位                              | 年代 |   平衡算法 程序       |         输运         |      开发环境                           |        
+===============================================================+==============================================+======+=======================+======================+=========================================+
| TRANSP :cite:`hawryluk_empirical_1981`                        |  美国/PPPL                                   | 1981 |       EFIT            |      PTSOLVER        |   scripts,Frotran                       |            
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| TRANSITOR :cite:`pereverzev_transitor-_1987`                  |  苏联/Kurchatov Institutes of Atomic Energy  | 1987 |                       |                      |      Frotran                            |            
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| ASTRA  :cite:`pereverzev_astraautomated_1991`                 |  欧洲/MAX-PLANCK-INSTITUT                    | 1991 | SPIDER(free-boundary) |         /            |    ASTRA DSL,Frotran                    |   
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| TASK/TR/TX  :cite:`hayashi_numerical_2004,honda_dynamic_2008` |  日本/Kyoto University                       | 1992 |     fixed-boundary    |                      |      Text,Frotran                       |              
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| DINA-CH  :cite:`khayrutdinov_studies_1993`                    |  俄罗斯/Institutes in Moscow                 | 1993 |     free-boundary     |                      |   Matlab/Simulink                       | 
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| TOPICS   :cite:`hayashi_integrated_2007`                      |  日本/JAEA                                   | 2004 |     free-boundary     |    Time dep. 1D      |     Text,Frotran                        |             
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| JINTRAC  :cite:`romanelli_jintrac_2014`                       |  英国/JET                                    | 2008 |     EFIT/ESCO         |        JETTO         |     Python,Frotran                      |             
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| CRONOS  :cite:`artaud_cronos_2010`                            |  法国/CEA IRFM                               | 2009 |   Fixed-boundary      |         ?            |   Matlab,Frotran                        |               
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| ETS  :cite:`coster_european_2010`                             |  欧盟/ITM-TF                                 | 2010 |       CHEASE          |          /           |    Kepler,Frotran                       |             
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| IPS  :cite:`elwasif_design_2010`                              |  美国/SWIM                                   | 2010 |         ?             |       FASTRAN        |            ?                            |     
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| IMAS  :cite:`imbeaux_design_2015`                             |  ITER                                        | 2011 |         /             |          /           |     Kepler,Python,Fortran,C/C++,Matlab  |           
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| ASTRA v7.0   :cite:`pereverzev_astra_2002`                    |  德国/MAX-PLANCK-INSTITUT                    | 2012 | SPIDER(free-boundary) |          /           |   ASTRA DSL,Frotran                     |                       
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+
| OMFIT  :cite:`meneghini_integrated_2015`                      |  美国/GA                                     | 2012 |       EFIT            |        ONETWO        |     Python,                             |           
+---------------------------------------------------------------+----------------------------------------------+------+-----------------------+----------------------+-----------------------------------------+


集成建模平台的涉及到 |Tokamak| 物理的诸多方面，应用范围广泛，会涉及到装置的各个方面。其开发离不开高层的项目支持和协调。
目前，国家级别集成建模合作项目计划主要有三个，
     
     * 美国 Whole Device Modeling, WDM   :cite:`bonoli_report_2015`
     * 欧盟 The European Integrated Tokamak Modelling Task Force (ITM-TF) :cite:`falchetto_european_2014`
     * 日本 Burning Plasma Simulation Initiative,BPSI :cite:`fukuyama_burning_2005`

上述程序大多为这三个项目支持下的成果。

ITER作为磁约束聚变界最大的国际合作项目，为了支持自身等离子体运行和研究工作，于2011年启动Integrated Modelling & Analysis Suite(IMAS) 项目开发。
IMAS在很大程度上复用了欧洲EU-ITM :cite:`falchetto_european_2014` 工作的成果，包括数据模型和工作流引擎 :cite:`imbeaux_design_2015`。

IMAS基础架构的骨干是标准化的*物理数据模型*。IMAS的数据模型精确并且完备的定义了 |Tokamak| 物理数据的方方面面和完整的生命周期过程。
以数据字典（data dictionary）的方式明确规范了数据的表述方式，保障了全局范围的一致性。IMAS数据模型采用层次化的组织方式，其访问的入口
称为 Interface Data Structure (IDS)。 每一个IDS表达一个相对独立的概念，例如，一个托卡马克子系统（诊断，加热系统等）的完整描述，
或抽象物理概念（平衡，芯部等离子体分布，波传播等）。IDS可以单独使用，作为物理模块之间的数据接口，方便的交换或传递大量的机构化数据变量。 
IDS也可以作为装置数据库的入口，将原本散落在各处的数据汇集到单一的访问路径下。IMAS标准化的数据模型设计过程，特别强调数据结构应与装置无关，
以保持其通用性，ITER只是数据模型的一个实例。






















