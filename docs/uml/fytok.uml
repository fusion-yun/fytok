@startuml
left to right direction
skinparam classFontName 'Noto Sans Mono CJK SC Regular'

package "Opreation 运行和控制系统" {
    [Pulse Schedule] --> [Controllers] 
    [SDN]
}

package "Device and Magnetics Field 装置位形，磁场线圈"{
    [Wall] 
    [TF]                        -->    Coils
    [PF Active]                 -->    Coils                    
    [Iron Core]                 -->    Coils
    [Coils Non Axisymmetric]    -->    Coils
    [EMCoupling]                -->    Coils

    [Magnetics] 

    ControlMagnetic --> [TF]                       
    ControlMagnetic --> [PF Active]                
    ControlMagnetic --> [Iron Core]                
    ControlMagnetic --> [Coils Non Axisymmetric]   
    ControlMagnetic --> [EMCoupling]               
}


package "Equilibrium and transport 平衡和输运" {
   [TransportSolver]    -->  [CoreProfiles]
   [Equilibrium]        --> [FluxSurface]  
   [FluxSurface]        --> [TransportSolver]
   [CoreProfiles]       --> [Equilibrium] 
   [CoreSources]        --> [TransportSolver]
   [CoreTransport]      --> [TransportSolver]
   [EdgeProfiles]
   [EdgeSources]
   [EdgeTransport]
}

package "Auxiliary 辅助系统，加热、驱动和加料" {
  [ECLaunchers]    -->  RF
  [ICAntennas]     -->  RF
  [LHAntennas]     -->  RF
  [NBI]            -->  Particles
  [Pellets]        -->  Particles   
  [GasInjection]   -->  Particles

  ControlAux --> [ECLaunchers]   
  ControlAux --> [ICAntennas]    
  ControlAux --> [LHAntennas]    
  ControlAux --> [NBI]           
  ControlAux --> [Pellets]       
  ControlAux --> [GasInjection]  

}



package "Plasma 等离子体" {
    [AMNSData]              --> Sources
    [Radiation]             --> Sources

    [Waves]                 --> Sources
    
    [DistributionSources]   --> [Gyrokinetics]
    [Distributions]         --> [Gyrokinetics]
    [Gyrokinetics]          --> Transport

    [MHD]                   --> Transport
    [MHDLinear]             --> Transport
    
    [NTMS]                  --> Transport
    [Sawteeth]              --> Transport    
    [Turbulence]            --> Transport

    [Core Instant Changes]  
    [Disruption]            
    

}

package "Diagnosis 诊断" {

    Diagnosis       --> [Barometry]
    Diagnosis       --> [Bolometer]
    Diagnosis       --> [BremsstrahlungVisible]
    Diagnosis       --> [CameraIR]
    Diagnosis       --> [CameraVisible]
    Diagnosis       --> [ChargeExchange]
    Diagnosis       --> [ECE]
    Diagnosis       --> [HardXRays]
    Diagnosis       --> [Interferometer]
    Diagnosis       --> [LangmuirProbes]
    Diagnosis       --> [MSE]
    Diagnosis       --> [NeutronDiagnostic]
    Diagnosis       --> [Polarimeter]
    Diagnosis       --> [ReflectometerProfile]
    Diagnosis       --> [SoftXRays]
    Diagnosis       --> [SpectrometerMass]
    Diagnosis       --> [SpectrometerUV]
    Diagnosis       --> [SpectrometerVisible]
    Diagnosis       --> [SpectrometerXRayCrystal]
    Diagnosis       --> [ThomsonScattering]

}


cloud "Simulator 模拟器"  {   
    [Tokamak] 
    [Scenario] 
}

[Scenario] -- [Pulse Schedule]   
[Scenario] -- [Tokamak]

Coils       --> [Equilibrium]
[Magnetics] --> [Equilibrium]


Transport   --> [CoreTransport] 


RF          --> [Waves]
Sources     --> [CoreSources] 
Particles   --> [CoreSources]

[Wall]              --> [Tokamak]
[Equilibrium]       --> [Tokamak]
[TransportSolver]   --> [Tokamak]

[Tokamak]           <--> Diagnosis
[Scenario]          --> [Controllers]
[Pulse Schedule]    --> ControlAux
[Controllers]       --> ControlMagnetic

@enduml